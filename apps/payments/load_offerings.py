from apps.core.constants import get_month_name, format_date, get_month_number
from apps.payments.models import Offering, ChurchLedger
from apps.core.models import UserActionLog
from apps.users.models import User
from django.db import transaction
from decimal import Decimal

user = User.objects.get(username="admin")

offerings_list = [
    {"branch": 5, "service": 2, "amount": 22395.14, "offering_date": "2010-10-29"},
    {"branch": 5, "service": 1, "amount": 17522.04, "offering_date": "2012-08-11"},
    {"branch": 5, "service": 1, "amount": 11205.41, "offering_date": "2010-10-01"},
    {"branch": 5, "service": 1, "amount": 33375.23, "offering_date": "2018-05-17"},
    {"branch": 5, "service": 1, "amount": 39937.45, "offering_date": "2011-01-01"},
    {"branch": 5, "service": 1, "amount": 32473.11, "offering_date": "2011-06-07"},
    {"branch": 5, "service": 1, "amount": 15978.84, "offering_date": "2019-05-12"},
    {"branch": 5, "service": 2, "amount": 37830.3, "offering_date": "2024-08-09"},
    {"branch": 5, "service": 2, "amount": 39021.51, "offering_date": "2020-05-15"},
    {"branch": 5, "service": 2, "amount": 46633.44, "offering_date": "2017-02-23"},
    {"branch": 5, "service": 1, "amount": 14474.29, "offering_date": "2012-11-03"},
    {"branch": 5, "service": 2, "amount": 20780.67, "offering_date": "2016-01-08"},
    {"branch": 5, "service": 1, "amount": 32470.86, "offering_date": "2011-03-24"},
    {"branch": 5, "service": 1, "amount": 24720.4, "offering_date": "2024-01-24"},
    {"branch": 5, "service": 1, "amount": 25952.29, "offering_date": "2013-05-25"},
    {"branch": 5, "service": 2, "amount": 26942.43, "offering_date": "2011-11-14"},
    {"branch": 5, "service": 1, "amount": 12235.44, "offering_date": "2015-03-29"},
    {"branch": 5, "service": 1, "amount": 14927.25, "offering_date": "2010-08-17"},
    {"branch": 5, "service": 2, "amount": 18926.94, "offering_date": "2019-07-26"},
    {"branch": 5, "service": 1, "amount": 32277.4, "offering_date": "2023-03-19"},
    {"branch": 5, "service": 2, "amount": 29602.69, "offering_date": "2010-03-01"},
    {"branch": 5, "service": 2, "amount": 23932.55, "offering_date": "2010-12-14"},
    {"branch": 5, "service": 1, "amount": 37441.59, "offering_date": "2022-08-18"},
    {"branch": 5, "service": 1, "amount": 27806.59, "offering_date": "2014-07-06"},
    {"branch": 5, "service": 2, "amount": 32897.31, "offering_date": "2017-07-24"},
    {"branch": 5, "service": 1, "amount": 14351.37, "offering_date": "2016-06-02"},
    {"branch": 5, "service": 1, "amount": 12266.92, "offering_date": "2024-01-23"},
    {"branch": 5, "service": 1, "amount": 28790.06, "offering_date": "2023-03-06"},
    {"branch": 5, "service": 2, "amount": 48297.49, "offering_date": "2016-05-07"},
    {"branch": 5, "service": 1, "amount": 30688.18, "offering_date": "2023-01-12"},
    {"branch": 5, "service": 1, "amount": 41268.87, "offering_date": "2020-02-18"},
    {"branch": 5, "service": 1, "amount": 42684.01, "offering_date": "2024-11-12"},
    {"branch": 5, "service": 2, "amount": 29911.84, "offering_date": "2010-04-25"},
    {"branch": 5, "service": 1, "amount": 34058.74, "offering_date": "2011-02-14"},
    {"branch": 5, "service": 1, "amount": 15397.75, "offering_date": "2014-05-03"},
    {"branch": 5, "service": 1, "amount": 27692.24, "offering_date": "2023-01-20"},
    {"branch": 5, "service": 2, "amount": 16815.66, "offering_date": "2014-09-01"},
    {"branch": 5, "service": 2, "amount": 25762.4, "offering_date": "2020-06-07"},
    {"branch": 5, "service": 2, "amount": 29109.87, "offering_date": "2010-06-04"},
    {"branch": 5, "service": 2, "amount": 31073.74, "offering_date": "2019-01-29"},
    {"branch": 5, "service": 2, "amount": 26412.62, "offering_date": "2021-10-07"},
    {"branch": 5, "service": 1, "amount": 28622.41, "offering_date": "2019-06-25"},
    {"branch": 5, "service": 2, "amount": 27557.05, "offering_date": "2021-12-24"},
    {"branch": 5, "service": 1, "amount": 21525.05, "offering_date": "2019-03-19"},
    {"branch": 5, "service": 2, "amount": 14758.59, "offering_date": "2011-04-03"},
    {"branch": 5, "service": 1, "amount": 24456.04, "offering_date": "2025-06-16"},
    {"branch": 5, "service": 2, "amount": 42745.04, "offering_date": "2016-06-01"},
    {"branch": 5, "service": 2, "amount": 15839.9, "offering_date": "2017-12-18"},
    {"branch": 5, "service": 1, "amount": 18490.36, "offering_date": "2014-09-22"},
    {"branch": 5, "service": 1, "amount": 29778.79, "offering_date": "2012-11-03"},
    {"branch": 5, "service": 2, "amount": 14016.62, "offering_date": "2018-05-13"},
    {"branch": 5, "service": 1, "amount": 33716.19, "offering_date": "2020-11-05"},
    {"branch": 5, "service": 2, "amount": 23473.29, "offering_date": "2013-07-20"},
    {"branch": 5, "service": 1, "amount": 22065.58, "offering_date": "2017-12-13"},
    {"branch": 5, "service": 1, "amount": 29151.41, "offering_date": "2017-10-16"},
    {"branch": 5, "service": 2, "amount": 28244.24, "offering_date": "2019-04-16"},
    {"branch": 5, "service": 2, "amount": 30575.04, "offering_date": "2023-02-13"},
    {"branch": 5, "service": 2, "amount": 41264.27, "offering_date": "2024-11-19"},
    {"branch": 5, "service": 2, "amount": 11276.29, "offering_date": "2023-06-11"},
    {"branch": 5, "service": 1, "amount": 38012.36, "offering_date": "2010-11-06"},
    {"branch": 5, "service": 1, "amount": 18782.95, "offering_date": "2020-12-09"},
    {"branch": 5, "service": 1, "amount": 36782.74, "offering_date": "2025-03-02"},
    {"branch": 5, "service": 2, "amount": 24909.27, "offering_date": "2012-10-09"},
    {"branch": 5, "service": 2, "amount": 49479.99, "offering_date": "2018-05-24"},
    {"branch": 5, "service": 1, "amount": 32783.23, "offering_date": "2020-02-29"},
    {"branch": 5, "service": 2, "amount": 23337.83, "offering_date": "2024-08-21"},
    {"branch": 5, "service": 2, "amount": 25338.33, "offering_date": "2021-01-31"},
    {"branch": 5, "service": 2, "amount": 41941.44, "offering_date": "2023-08-21"},
    {"branch": 5, "service": 2, "amount": 41612.69, "offering_date": "2013-07-05"},
    {"branch": 5, "service": 1, "amount": 11693.53, "offering_date": "2015-12-17"},
    {"branch": 5, "service": 2, "amount": 41888.96, "offering_date": "2016-02-02"},
    {"branch": 5, "service": 1, "amount": 46915.69, "offering_date": "2014-09-30"},
    {"branch": 5, "service": 2, "amount": 17050.44, "offering_date": "2020-06-10"},
    {"branch": 5, "service": 1, "amount": 41707.07, "offering_date": "2022-08-30"},
    {"branch": 5, "service": 2, "amount": 45569.49, "offering_date": "2018-12-23"},
    {"branch": 5, "service": 2, "amount": 24895.23, "offering_date": "2015-08-30"},
    {"branch": 5, "service": 1, "amount": 29795.88, "offering_date": "2010-07-24"},
    {"branch": 5, "service": 2, "amount": 12625.74, "offering_date": "2012-05-16"},
    {"branch": 5, "service": 1, "amount": 20357.08, "offering_date": "2019-01-31"},
    {"branch": 5, "service": 1, "amount": 29930.83, "offering_date": "2022-08-26"},
    {"branch": 5, "service": 1, "amount": 34534.84, "offering_date": "2022-01-22"},
    {"branch": 5, "service": 2, "amount": 18797.4, "offering_date": "2010-08-07"},
    {"branch": 5, "service": 2, "amount": 18647.79, "offering_date": "2018-07-29"},
    {"branch": 5, "service": 2, "amount": 16437.45, "offering_date": "2017-01-15"},
    {"branch": 5, "service": 1, "amount": 38832.02, "offering_date": "2023-11-20"},
    {"branch": 5, "service": 2, "amount": 37174.39, "offering_date": "2022-02-19"},
    {"branch": 5, "service": 2, "amount": 16146.53, "offering_date": "2013-10-26"},
    {"branch": 5, "service": 1, "amount": 21670.06, "offering_date": "2014-03-27"},
    {"branch": 5, "service": 1, "amount": 15160.95, "offering_date": "2013-06-14"},
    {"branch": 5, "service": 1, "amount": 33557.95, "offering_date": "2019-03-23"},
    {"branch": 5, "service": 2, "amount": 43981.18, "offering_date": "2019-02-15"},
    {"branch": 5, "service": 2, "amount": 43091.2, "offering_date": "2010-09-13"},
    {"branch": 5, "service": 1, "amount": 45851.56, "offering_date": "2022-03-30"},
    {"branch": 5, "service": 1, "amount": 42305.48, "offering_date": "2021-11-14"},
    {"branch": 5, "service": 1, "amount": 47618.94, "offering_date": "2020-09-08"},
    {"branch": 5, "service": 2, "amount": 41230.26, "offering_date": "2017-08-04"},
    {"branch": 5, "service": 1, "amount": 42021.06, "offering_date": "2018-04-21"},
    {"branch": 5, "service": 2, "amount": 42314.02, "offering_date": "2012-07-23"},
    {"branch": 5, "service": 1, "amount": 12535.98, "offering_date": "2011-04-29"},
    {"branch": 5, "service": 2, "amount": 34280.67, "offering_date": "2024-03-20"},
    {"branch": 5, "service": 2, "amount": 38888.05, "offering_date": "2010-11-12"},
    {"branch": 5, "service": 2, "amount": 25859.19, "offering_date": "2016-06-22"},
    {"branch": 5, "service": 1, "amount": 43623.71, "offering_date": "2010-03-30"},
    {"branch": 5, "service": 1, "amount": 13988.54, "offering_date": "2010-03-27"},
    {"branch": 5, "service": 2, "amount": 45850.55, "offering_date": "2016-06-10"},
    {"branch": 5, "service": 1, "amount": 45530.36, "offering_date": "2016-10-26"},
    {"branch": 5, "service": 1, "amount": 42699.29, "offering_date": "2021-06-29"},
    {"branch": 5, "service": 1, "amount": 27933.36, "offering_date": "2024-11-07"},
    {"branch": 5, "service": 1, "amount": 28449.35, "offering_date": "2016-01-05"},
    {"branch": 5, "service": 1, "amount": 21477.35, "offering_date": "2016-12-23"},
    {"branch": 5, "service": 2, "amount": 41540.29, "offering_date": "2019-06-18"},
    {"branch": 5, "service": 2, "amount": 38662.69, "offering_date": "2015-08-24"},
    {"branch": 5, "service": 1, "amount": 36785.42, "offering_date": "2014-01-18"},
    {"branch": 5, "service": 1, "amount": 15321.02, "offering_date": "2016-03-05"},
    {"branch": 5, "service": 2, "amount": 44816.11, "offering_date": "2023-11-08"},
    {"branch": 5, "service": 2, "amount": 42007.99, "offering_date": "2025-05-28"},
    {"branch": 5, "service": 2, "amount": 40919.27, "offering_date": "2015-07-09"},
    {"branch": 5, "service": 1, "amount": 36958.42, "offering_date": "2015-01-05"},
    {"branch": 5, "service": 1, "amount": 17089.27, "offering_date": "2017-09-10"},
    {"branch": 5, "service": 1, "amount": 15078.64, "offering_date": "2025-01-09"},
    {"branch": 5, "service": 2, "amount": 37230.17, "offering_date": "2014-11-24"},
    {"branch": 5, "service": 2, "amount": 34864.8, "offering_date": "2022-03-18"},
    {"branch": 5, "service": 2, "amount": 14567.96, "offering_date": "2010-10-14"},
    {"branch": 5, "service": 1, "amount": 13804.66, "offering_date": "2023-06-11"},
    {"branch": 5, "service": 2, "amount": 39323.88, "offering_date": "2014-08-18"},
    {"branch": 5, "service": 2, "amount": 35403.48, "offering_date": "2018-07-18"},
    {"branch": 5, "service": 2, "amount": 33503.94, "offering_date": "2019-11-15"},
    {"branch": 5, "service": 1, "amount": 35709.28, "offering_date": "2023-01-17"},
    {"branch": 5, "service": 1, "amount": 19641.09, "offering_date": "2011-06-21"},
    {"branch": 5, "service": 1, "amount": 16843.66, "offering_date": "2012-10-20"},
    {"branch": 5, "service": 2, "amount": 20578.57, "offering_date": "2019-06-26"},
    {"branch": 5, "service": 1, "amount": 35380.56, "offering_date": "2018-10-04"},
    {"branch": 5, "service": 1, "amount": 31903.21, "offering_date": "2017-07-26"},
    {"branch": 5, "service": 2, "amount": 40935.28, "offering_date": "2020-08-24"},
    {"branch": 5, "service": 1, "amount": 49037.1, "offering_date": "2016-08-15"},
    {"branch": 5, "service": 2, "amount": 37262.34, "offering_date": "2017-04-17"},
    {"branch": 5, "service": 2, "amount": 22816.37, "offering_date": "2024-01-28"},
    {"branch": 5, "service": 1, "amount": 11105.24, "offering_date": "2020-06-10"},
    {"branch": 5, "service": 1, "amount": 36383.05, "offering_date": "2019-01-17"},
    {"branch": 5, "service": 2, "amount": 22340.95, "offering_date": "2021-12-07"},
    {"branch": 5, "service": 2, "amount": 43007.07, "offering_date": "2022-04-29"},
    {"branch": 5, "service": 2, "amount": 46149.25, "offering_date": "2023-01-17"},
    {"branch": 5, "service": 1, "amount": 48918.48, "offering_date": "2011-02-18"},
    {"branch": 5, "service": 2, "amount": 42914.0, "offering_date": "2010-10-09"},
    {"branch": 5, "service": 2, "amount": 22393.47, "offering_date": "2010-02-21"},
    {"branch": 5, "service": 1, "amount": 42798.69, "offering_date": "2023-10-24"},
    {"branch": 5, "service": 2, "amount": 13096.33, "offering_date": "2015-01-27"},
    {"branch": 5, "service": 2, "amount": 27273.14, "offering_date": "2011-10-20"},
    {"branch": 5, "service": 2, "amount": 35194.98, "offering_date": "2015-01-08"},
    {"branch": 5, "service": 1, "amount": 26325.06, "offering_date": "2022-01-12"},
    {"branch": 5, "service": 2, "amount": 14011.15, "offering_date": "2017-10-07"},
    {"branch": 5, "service": 1, "amount": 32826.92, "offering_date": "2023-12-20"},
    {"branch": 5, "service": 1, "amount": 43827.41, "offering_date": "2015-06-14"},
    {"branch": 5, "service": 2, "amount": 44244.07, "offering_date": "2011-01-12"},
    {"branch": 5, "service": 1, "amount": 41022.32, "offering_date": "2016-05-26"},
    {"branch": 5, "service": 2, "amount": 22372.78, "offering_date": "2024-03-17"},
    {"branch": 5, "service": 2, "amount": 19163.06, "offering_date": "2023-06-20"},
    {"branch": 5, "service": 2, "amount": 23293.52, "offering_date": "2013-07-04"},
    {"branch": 5, "service": 2, "amount": 28018.11, "offering_date": "2011-03-05"},
    {"branch": 5, "service": 2, "amount": 36018.58, "offering_date": "2019-01-10"},
    {"branch": 5, "service": 1, "amount": 27230.9, "offering_date": "2019-09-01"},
    {"branch": 5, "service": 1, "amount": 39468.4, "offering_date": "2016-02-24"},
    {"branch": 5, "service": 1, "amount": 25572.12, "offering_date": "2014-09-19"},
    {"branch": 5, "service": 2, "amount": 10039.65, "offering_date": "2014-06-28"},
    {"branch": 5, "service": 1, "amount": 15901.52, "offering_date": "2013-12-21"},
    {"branch": 5, "service": 1, "amount": 15795.0, "offering_date": "2021-05-18"},
    {"branch": 5, "service": 2, "amount": 17867.56, "offering_date": "2017-08-28"},
    {"branch": 5, "service": 1, "amount": 22515.77, "offering_date": "2025-01-18"},
    {"branch": 5, "service": 1, "amount": 42720.68, "offering_date": "2019-02-14"},
    {"branch": 5, "service": 2, "amount": 21324.27, "offering_date": "2023-08-29"},
    {"branch": 5, "service": 1, "amount": 15879.85, "offering_date": "2019-07-25"},
    {"branch": 5, "service": 1, "amount": 36102.81, "offering_date": "2020-06-04"},
    {"branch": 5, "service": 2, "amount": 19709.47, "offering_date": "2024-08-31"},
    {"branch": 5, "service": 1, "amount": 25282.47, "offering_date": "2014-04-08"},
    {"branch": 5, "service": 1, "amount": 20309.52, "offering_date": "2018-08-06"},
    {"branch": 5, "service": 1, "amount": 21961.61, "offering_date": "2010-05-13"},
    {"branch": 5, "service": 1, "amount": 22043.06, "offering_date": "2023-10-01"},
    {"branch": 5, "service": 1, "amount": 33802.16, "offering_date": "2018-08-15"},
    {"branch": 5, "service": 2, "amount": 32594.94, "offering_date": "2021-06-17"},
    {"branch": 5, "service": 2, "amount": 17209.68, "offering_date": "2024-08-07"},
    {"branch": 5, "service": 1, "amount": 45351.3, "offering_date": "2022-12-27"},
    {"branch": 5, "service": 1, "amount": 39077.2, "offering_date": "2025-01-16"},
    {"branch": 5, "service": 1, "amount": 29151.84, "offering_date": "2024-10-24"},
    {"branch": 5, "service": 2, "amount": 38275.6, "offering_date": "2011-01-19"},
    {"branch": 5, "service": 2, "amount": 16328.47, "offering_date": "2010-09-21"},
    {"branch": 5, "service": 1, "amount": 43072.8, "offering_date": "2025-05-02"},
    {"branch": 5, "service": 1, "amount": 38742.53, "offering_date": "2022-01-17"},
    {"branch": 5, "service": 2, "amount": 23869.13, "offering_date": "2019-11-30"},
    {"branch": 5, "service": 2, "amount": 15855.77, "offering_date": "2010-05-29"},
    {"branch": 5, "service": 2, "amount": 46224.44, "offering_date": "2025-02-14"},
    {"branch": 5, "service": 2, "amount": 22530.88, "offering_date": "2022-10-14"},
    {"branch": 5, "service": 1, "amount": 38081.73, "offering_date": "2025-02-16"},
    {"branch": 5, "service": 2, "amount": 16337.98, "offering_date": "2022-01-10"},
    {"branch": 5, "service": 2, "amount": 41016.47, "offering_date": "2022-03-13"},
    {"branch": 5, "service": 2, "amount": 17862.94, "offering_date": "2017-07-17"},
    {"branch": 5, "service": 2, "amount": 41000.53, "offering_date": "2020-03-03"},
    {"branch": 5, "service": 1, "amount": 30015.01, "offering_date": "2016-07-28"},
    {"branch": 5, "service": 1, "amount": 46592.14, "offering_date": "2023-09-11"},
    {"branch": 5, "service": 2, "amount": 46057.63, "offering_date": "2022-09-29"},
    {"branch": 5, "service": 2, "amount": 34093.86, "offering_date": "2021-10-09"},
]


@transaction.atomic
def load_offerings():
    for x in offerings_list:
        date_obj = format_date(x["offering_date"])
        month_name = get_month_name(date_obj.month)
        year = date_obj.year

        offering = Offering.objects.create(
            branch_id=x["branch"],
            service_id=x["service"],
            amount=x["amount"],
            offering_date=x["offering_date"],
            month=month_name,
            year=year,
            captured_by=user,
        )

        ChurchLedger.objects.create(
            name=f"{offering.service.name} {x["offering_date"]} Offering",
            description=f"Offering - {offering.service.name} - {offering.branch.name}",
            amount=Decimal(x["amount"]),
            direction="Income",
            user=user,
            month=month_name,
            year=year,
            transaction_date=x["offering_date"],
        )

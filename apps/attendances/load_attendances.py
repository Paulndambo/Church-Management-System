from apps.core.constants import get_month_name, get_month_number, format_date
from apps.core.models import UserActionLog
from apps.users.models import User
from apps.attendances.models import ChurchService, ServiceAttendanceMetric
from apps.membership.models import Branch


user = User.objects.filter(username="admin").first()

records = [{"branch":5,"service":3,"service_date":"2014-04-29","total_present":1149},
{"branch":5,"service":3,"service_date":"2020-03-19","total_present":1406},
{"branch":5,"service":1,"service_date":"2022-12-20","total_present":175},
{"branch":5,"service":3,"service_date":"2021-03-01","total_present":895},
{"branch":5,"service":1,"service_date":"2024-10-05","total_present":1165},
{"branch":5,"service":2,"service_date":"2016-05-04","total_present":813},
{"branch":5,"service":1,"service_date":"2023-07-07","total_present":915},
{"branch":5,"service":1,"service_date":"2022-03-02","total_present":455},
{"branch":5,"service":3,"service_date":"2013-02-07","total_present":190},
{"branch":5,"service":1,"service_date":"2015-12-16","total_present":785},
{"branch":5,"service":3,"service_date":"2010-06-11","total_present":442},
{"branch":5,"service":3,"service_date":"2017-10-09","total_present":594},
{"branch":5,"service":2,"service_date":"2012-05-11","total_present":1846},
{"branch":5,"service":3,"service_date":"2024-10-30","total_present":1566},
{"branch":5,"service":1,"service_date":"2014-10-31","total_present":488},
{"branch":5,"service":2,"service_date":"2017-03-16","total_present":1197},
{"branch":5,"service":1,"service_date":"2023-06-04","total_present":796},
{"branch":5,"service":1,"service_date":"2022-10-10","total_present":710},
{"branch":5,"service":3,"service_date":"2012-09-20","total_present":1301},
{"branch":5,"service":2,"service_date":"2016-01-21","total_present":1978},
{"branch":5,"service":1,"service_date":"2017-03-19","total_present":720},
{"branch":5,"service":1,"service_date":"2023-03-21","total_present":1750},
{"branch":5,"service":3,"service_date":"2018-02-17","total_present":1488},
{"branch":5,"service":2,"service_date":"2014-08-08","total_present":842},
{"branch":5,"service":2,"service_date":"2010-03-24","total_present":1921},
{"branch":5,"service":3,"service_date":"2015-09-05","total_present":1843},
{"branch":5,"service":3,"service_date":"2012-12-09","total_present":790},
{"branch":5,"service":1,"service_date":"2019-03-22","total_present":1521},
{"branch":5,"service":2,"service_date":"2017-03-08","total_present":1820},
{"branch":5,"service":2,"service_date":"2021-06-30","total_present":538},
{"branch":5,"service":3,"service_date":"2018-01-06","total_present":1756},
{"branch":5,"service":3,"service_date":"2019-07-31","total_present":1487},
{"branch":5,"service":3,"service_date":"2022-08-31","total_present":1191},
{"branch":5,"service":2,"service_date":"2023-10-05","total_present":1257},
{"branch":5,"service":3,"service_date":"2021-02-15","total_present":1237},
{"branch":5,"service":3,"service_date":"2016-01-12","total_present":183},
{"branch":5,"service":1,"service_date":"2018-03-28","total_present":1071},
{"branch":5,"service":2,"service_date":"2022-11-17","total_present":1777},
{"branch":5,"service":3,"service_date":"2014-07-07","total_present":173},
{"branch":5,"service":1,"service_date":"2013-08-12","total_present":1144},
{"branch":5,"service":2,"service_date":"2010-05-24","total_present":649},
{"branch":5,"service":2,"service_date":"2022-02-25","total_present":1798},
{"branch":5,"service":3,"service_date":"2013-08-26","total_present":1939},
{"branch":5,"service":2,"service_date":"2021-06-02","total_present":1566},
{"branch":5,"service":1,"service_date":"2021-03-25","total_present":128},
{"branch":5,"service":1,"service_date":"2019-04-09","total_present":1516},
{"branch":5,"service":3,"service_date":"2011-07-23","total_present":1981},
{"branch":5,"service":1,"service_date":"2015-12-14","total_present":1248},
{"branch":5,"service":3,"service_date":"2018-12-23","total_present":671},
{"branch":5,"service":1,"service_date":"2018-02-22","total_present":1964},
{"branch":5,"service":1,"service_date":"2019-07-04","total_present":100},
{"branch":5,"service":1,"service_date":"2023-10-29","total_present":785},
{"branch":5,"service":3,"service_date":"2017-08-06","total_present":888},
{"branch":5,"service":1,"service_date":"2022-11-17","total_present":1857},
{"branch":5,"service":2,"service_date":"2014-03-04","total_present":1213},
{"branch":5,"service":2,"service_date":"2013-04-10","total_present":846},
{"branch":5,"service":1,"service_date":"2024-09-21","total_present":1369},
{"branch":5,"service":1,"service_date":"2018-05-30","total_present":104},
{"branch":5,"service":2,"service_date":"2024-06-07","total_present":829},
{"branch":5,"service":1,"service_date":"2012-08-01","total_present":1290},
{"branch":5,"service":3,"service_date":"2024-05-14","total_present":1870},
{"branch":5,"service":2,"service_date":"2019-01-01","total_present":986},
{"branch":5,"service":1,"service_date":"2013-02-13","total_present":906},
{"branch":5,"service":3,"service_date":"2011-01-17","total_present":713},
{"branch":5,"service":1,"service_date":"2012-11-20","total_present":1907},
{"branch":5,"service":2,"service_date":"2024-02-05","total_present":887},
{"branch":5,"service":3,"service_date":"2014-08-18","total_present":450},
{"branch":5,"service":1,"service_date":"2023-05-16","total_present":707},
{"branch":5,"service":3,"service_date":"2025-03-30","total_present":216},
{"branch":5,"service":2,"service_date":"2016-04-06","total_present":792},
{"branch":5,"service":2,"service_date":"2013-08-05","total_present":1715},
{"branch":5,"service":2,"service_date":"2024-07-16","total_present":1433},
{"branch":5,"service":3,"service_date":"2023-04-25","total_present":1085},
{"branch":5,"service":2,"service_date":"2017-10-21","total_present":257},
{"branch":5,"service":1,"service_date":"2013-09-22","total_present":231},
{"branch":5,"service":3,"service_date":"2013-06-15","total_present":1621},
{"branch":5,"service":1,"service_date":"2020-05-15","total_present":493},
{"branch":5,"service":2,"service_date":"2015-03-31","total_present":1848},
{"branch":5,"service":3,"service_date":"2025-03-15","total_present":454},
{"branch":5,"service":1,"service_date":"2015-03-27","total_present":1162},
{"branch":5,"service":3,"service_date":"2019-05-03","total_present":1175},
{"branch":5,"service":2,"service_date":"2011-07-15","total_present":470},
{"branch":5,"service":3,"service_date":"2012-08-24","total_present":105},
{"branch":5,"service":1,"service_date":"2021-03-24","total_present":200},
{"branch":5,"service":2,"service_date":"2017-01-12","total_present":1554},
{"branch":5,"service":1,"service_date":"2024-01-27","total_present":1940},
{"branch":5,"service":3,"service_date":"2010-09-28","total_present":1435},
{"branch":5,"service":3,"service_date":"2021-03-20","total_present":524},
{"branch":5,"service":2,"service_date":"2011-08-31","total_present":675},
{"branch":5,"service":3,"service_date":"2018-06-28","total_present":1893},
{"branch":5,"service":1,"service_date":"2019-06-26","total_present":647},
{"branch":5,"service":2,"service_date":"2019-12-12","total_present":1691},
{"branch":5,"service":3,"service_date":"2020-09-05","total_present":1959},
{"branch":5,"service":3,"service_date":"2012-07-04","total_present":1060},
{"branch":5,"service":2,"service_date":"2023-07-14","total_present":442},
{"branch":5,"service":2,"service_date":"2019-05-11","total_present":1897},
{"branch":5,"service":3,"service_date":"2023-12-20","total_present":1017},
{"branch":5,"service":1,"service_date":"2024-12-02","total_present":468},
{"branch":5,"service":2,"service_date":"2015-06-02","total_present":1350},
{"branch":5,"service":1,"service_date":"2011-03-20","total_present":459},
{"branch":5,"service":2,"service_date":"2014-07-20","total_present":1110},
{"branch":5,"service":1,"service_date":"2019-10-05","total_present":1889},
{"branch":5,"service":1,"service_date":"2011-11-06","total_present":1936},
{"branch":5,"service":3,"service_date":"2019-10-01","total_present":1406},
{"branch":5,"service":3,"service_date":"2014-12-29","total_present":400},
{"branch":5,"service":3,"service_date":"2019-08-09","total_present":1455},
{"branch":5,"service":3,"service_date":"2010-07-23","total_present":1615},
{"branch":5,"service":1,"service_date":"2022-01-30","total_present":752},
{"branch":5,"service":3,"service_date":"2023-02-11","total_present":1059},
{"branch":5,"service":3,"service_date":"2018-03-27","total_present":1953},
{"branch":5,"service":1,"service_date":"2012-04-15","total_present":360},
{"branch":5,"service":1,"service_date":"2023-07-08","total_present":1969},
{"branch":5,"service":3,"service_date":"2019-12-11","total_present":1332},
{"branch":5,"service":1,"service_date":"2020-06-09","total_present":1611},
{"branch":5,"service":1,"service_date":"2011-11-07","total_present":369},
{"branch":5,"service":3,"service_date":"2013-05-06","total_present":1027},
{"branch":5,"service":2,"service_date":"2013-12-18","total_present":1957},
{"branch":5,"service":2,"service_date":"2011-06-21","total_present":1997},
{"branch":5,"service":3,"service_date":"2022-02-01","total_present":347},
{"branch":5,"service":2,"service_date":"2020-01-08","total_present":1221},
{"branch":5,"service":3,"service_date":"2014-12-12","total_present":1540},
{"branch":5,"service":1,"service_date":"2022-06-25","total_present":1896},
{"branch":5,"service":1,"service_date":"2025-06-29","total_present":1711},
{"branch":5,"service":2,"service_date":"2017-10-14","total_present":1207},
{"branch":5,"service":2,"service_date":"2015-06-28","total_present":1016},
{"branch":5,"service":2,"service_date":"2011-03-15","total_present":918},
{"branch":5,"service":3,"service_date":"2013-08-28","total_present":346},
{"branch":5,"service":2,"service_date":"2016-06-29","total_present":1252},
{"branch":5,"service":3,"service_date":"2022-09-22","total_present":360},
{"branch":5,"service":1,"service_date":"2021-03-30","total_present":523},
{"branch":5,"service":3,"service_date":"2021-07-29","total_present":1663},
{"branch":5,"service":1,"service_date":"2025-03-07","total_present":1633},
{"branch":5,"service":1,"service_date":"2021-03-01","total_present":638},
{"branch":5,"service":3,"service_date":"2022-02-23","total_present":159},
{"branch":5,"service":1,"service_date":"2018-07-09","total_present":328},
{"branch":5,"service":2,"service_date":"2012-03-12","total_present":1235},
{"branch":5,"service":2,"service_date":"2015-05-22","total_present":510},
{"branch":5,"service":1,"service_date":"2024-01-02","total_present":170},
{"branch":5,"service":3,"service_date":"2020-08-17","total_present":586},
{"branch":5,"service":3,"service_date":"2023-01-05","total_present":871},
{"branch":5,"service":2,"service_date":"2018-09-14","total_present":1610},
{"branch":5,"service":3,"service_date":"2010-12-26","total_present":258},
{"branch":5,"service":2,"service_date":"2023-07-09","total_present":441},
{"branch":5,"service":3,"service_date":"2019-03-05","total_present":1862},
{"branch":5,"service":2,"service_date":"2013-03-09","total_present":717},
{"branch":5,"service":3,"service_date":"2012-07-14","total_present":589},
{"branch":5,"service":3,"service_date":"2019-12-25","total_present":1037},
{"branch":5,"service":3,"service_date":"2015-03-01","total_present":977},
{"branch":5,"service":1,"service_date":"2022-01-04","total_present":1867},
{"branch":5,"service":1,"service_date":"2023-07-19","total_present":1934},
{"branch":5,"service":2,"service_date":"2017-03-23","total_present":1168},
{"branch":5,"service":2,"service_date":"2018-08-16","total_present":554},
{"branch":5,"service":2,"service_date":"2016-05-15","total_present":1657},
{"branch":5,"service":1,"service_date":"2015-02-06","total_present":548},
{"branch":5,"service":2,"service_date":"2024-03-03","total_present":1040},
{"branch":5,"service":2,"service_date":"2020-04-12","total_present":780},
{"branch":5,"service":3,"service_date":"2010-06-12","total_present":1894},
{"branch":5,"service":2,"service_date":"2020-07-19","total_present":491},
{"branch":5,"service":1,"service_date":"2024-08-16","total_present":1778},
{"branch":5,"service":1,"service_date":"2016-06-21","total_present":1530},
{"branch":5,"service":2,"service_date":"2017-07-18","total_present":1458},
{"branch":5,"service":3,"service_date":"2023-07-19","total_present":1145},
{"branch":5,"service":1,"service_date":"2019-07-01","total_present":245},
{"branch":5,"service":1,"service_date":"2011-03-08","total_present":1612},
{"branch":5,"service":3,"service_date":"2024-11-22","total_present":1630},
{"branch":5,"service":1,"service_date":"2025-06-04","total_present":606},
{"branch":5,"service":2,"service_date":"2014-08-24","total_present":658},
{"branch":5,"service":2,"service_date":"2023-07-09","total_present":175},
{"branch":5,"service":2,"service_date":"2011-10-29","total_present":725},
{"branch":5,"service":2,"service_date":"2015-03-25","total_present":1263},
{"branch":5,"service":2,"service_date":"2023-07-06","total_present":1823},
{"branch":5,"service":2,"service_date":"2010-04-23","total_present":601},
{"branch":5,"service":1,"service_date":"2014-07-10","total_present":565},
{"branch":5,"service":2,"service_date":"2010-04-12","total_present":1147},
{"branch":5,"service":3,"service_date":"2022-09-26","total_present":240},
{"branch":5,"service":2,"service_date":"2012-06-05","total_present":249},
{"branch":5,"service":2,"service_date":"2014-02-23","total_present":407},
{"branch":5,"service":1,"service_date":"2023-03-11","total_present":1327},
{"branch":5,"service":3,"service_date":"2022-06-18","total_present":1363},
{"branch":5,"service":3,"service_date":"2016-01-21","total_present":1413},
{"branch":5,"service":1,"service_date":"2010-10-14","total_present":1502},
{"branch":5,"service":2,"service_date":"2016-11-09","total_present":1982},
{"branch":5,"service":1,"service_date":"2024-04-28","total_present":721},
{"branch":5,"service":1,"service_date":"2021-12-30","total_present":960},
{"branch":5,"service":1,"service_date":"2024-10-03","total_present":1957},
{"branch":5,"service":3,"service_date":"2022-03-25","total_present":1469},
{"branch":5,"service":3,"service_date":"2020-05-14","total_present":728},
{"branch":5,"service":3,"service_date":"2017-07-14","total_present":252},
{"branch":5,"service":2,"service_date":"2016-12-04","total_present":425},
{"branch":5,"service":2,"service_date":"2012-03-03","total_present":509},
{"branch":5,"service":3,"service_date":"2015-05-16","total_present":993},
{"branch":5,"service":2,"service_date":"2021-02-13","total_present":491},
{"branch":5,"service":2,"service_date":"2015-10-01","total_present":736},
{"branch":5,"service":3,"service_date":"2021-09-29","total_present":1963},
{"branch":5,"service":3,"service_date":"2022-11-09","total_present":1412},
{"branch":5,"service":2,"service_date":"2019-03-28","total_present":160},
{"branch":5,"service":2,"service_date":"2022-08-07","total_present":694},
{"branch":5,"service":3,"service_date":"2012-08-30","total_present":206},
{"branch":5,"service":2,"service_date":"2018-01-04","total_present":633},
{"branch":5,"service":2,"service_date":"2012-06-22","total_present":954},
{"branch":5,"service":2,"service_date":"2021-03-11","total_present":781},
{"branch":5,"service":1,"service_date":"2015-11-30","total_present":1331},
{"branch":5,"service":1,"service_date":"2022-09-13","total_present":1288},
{"branch":5,"service":2,"service_date":"2020-04-06","total_present":414},
{"branch":5,"service":2,"service_date":"2018-01-30","total_present":957},
{"branch":5,"service":1,"service_date":"2023-01-28","total_present":983},
{"branch":5,"service":1,"service_date":"2012-06-02","total_present":643},
{"branch":5,"service":2,"service_date":"2013-01-21","total_present":1087},
{"branch":5,"service":1,"service_date":"2012-12-17","total_present":1357},
{"branch":5,"service":1,"service_date":"2024-08-01","total_present":1440},
{"branch":5,"service":3,"service_date":"2022-12-30","total_present":266},
{"branch":5,"service":3,"service_date":"2018-12-24","total_present":146},
{"branch":5,"service":1,"service_date":"2012-08-26","total_present":1761},
{"branch":5,"service":3,"service_date":"2024-11-28","total_present":399},
{"branch":5,"service":2,"service_date":"2018-10-26","total_present":1852},
{"branch":5,"service":1,"service_date":"2021-10-27","total_present":1682},
{"branch":5,"service":1,"service_date":"2011-11-04","total_present":560},
{"branch":5,"service":3,"service_date":"2016-04-07","total_present":1678},
{"branch":5,"service":2,"service_date":"2017-09-10","total_present":157},
{"branch":5,"service":1,"service_date":"2015-04-01","total_present":158},
{"branch":5,"service":3,"service_date":"2015-03-06","total_present":1243},
{"branch":5,"service":3,"service_date":"2011-05-18","total_present":1304},
{"branch":5,"service":1,"service_date":"2023-05-15","total_present":1612},
{"branch":5,"service":3,"service_date":"2015-08-14","total_present":239},
{"branch":5,"service":3,"service_date":"2017-03-25","total_present":681},
{"branch":5,"service":1,"service_date":"2018-11-17","total_present":692},
{"branch":5,"service":1,"service_date":"2018-03-14","total_present":1749},
{"branch":5,"service":2,"service_date":"2020-02-09","total_present":1787},
{"branch":5,"service":1,"service_date":"2013-02-07","total_present":191},
{"branch":5,"service":1,"service_date":"2013-06-21","total_present":986},
{"branch":5,"service":2,"service_date":"2011-02-26","total_present":1851},
{"branch":5,"service":1,"service_date":"2024-05-10","total_present":350},
{"branch":5,"service":2,"service_date":"2021-02-28","total_present":781},
{"branch":5,"service":3,"service_date":"2024-03-29","total_present":569},
{"branch":5,"service":2,"service_date":"2020-08-16","total_present":773},
{"branch":5,"service":3,"service_date":"2022-12-20","total_present":675},
{"branch":5,"service":3,"service_date":"2019-08-13","total_present":1931},
{"branch":5,"service":1,"service_date":"2017-02-05","total_present":789},
{"branch":5,"service":1,"service_date":"2016-12-09","total_present":1954},
{"branch":5,"service":2,"service_date":"2023-01-22","total_present":1092},
{"branch":5,"service":2,"service_date":"2021-11-02","total_present":1859},
{"branch":5,"service":2,"service_date":"2015-09-16","total_present":1534},
{"branch":5,"service":1,"service_date":"2025-07-24","total_present":1821},
{"branch":5,"service":1,"service_date":"2014-12-07","total_present":1089},
{"branch":5,"service":1,"service_date":"2017-05-30","total_present":702},
{"branch":5,"service":2,"service_date":"2024-12-11","total_present":949},
{"branch":5,"service":2,"service_date":"2021-06-30","total_present":415},
{"branch":5,"service":1,"service_date":"2010-10-20","total_present":1736},
{"branch":5,"service":3,"service_date":"2023-05-04","total_present":1099},
{"branch":5,"service":1,"service_date":"2014-12-02","total_present":1498},
{"branch":5,"service":3,"service_date":"2014-08-19","total_present":1770},
{"branch":5,"service":2,"service_date":"2012-02-08","total_present":313},
{"branch":5,"service":3,"service_date":"2018-10-15","total_present":734},
{"branch":5,"service":2,"service_date":"2025-07-07","total_present":1739},
{"branch":5,"service":3,"service_date":"2021-03-29","total_present":1329},
{"branch":5,"service":3,"service_date":"2012-03-08","total_present":564},
{"branch":5,"service":3,"service_date":"2025-05-23","total_present":1136},
{"branch":5,"service":2,"service_date":"2022-05-11","total_present":415},
{"branch":5,"service":2,"service_date":"2023-08-26","total_present":590},
{"branch":5,"service":1,"service_date":"2011-12-08","total_present":1092},
{"branch":5,"service":1,"service_date":"2015-12-12","total_present":323},
{"branch":5,"service":3,"service_date":"2016-05-14","total_present":862},
{"branch":5,"service":1,"service_date":"2015-06-08","total_present":1233},
{"branch":5,"service":2,"service_date":"2021-09-14","total_present":1760},
{"branch":5,"service":3,"service_date":"2015-03-22","total_present":679},
{"branch":5,"service":2,"service_date":"2013-07-17","total_present":1158},
{"branch":5,"service":1,"service_date":"2015-04-21","total_present":173},
{"branch":5,"service":2,"service_date":"2014-07-10","total_present":1832},
{"branch":5,"service":1,"service_date":"2017-12-13","total_present":485},
{"branch":5,"service":2,"service_date":"2023-08-26","total_present":314},
{"branch":5,"service":2,"service_date":"2022-02-16","total_present":764},
{"branch":5,"service":1,"service_date":"2019-03-06","total_present":233},
{"branch":5,"service":3,"service_date":"2013-01-07","total_present":1321},
{"branch":5,"service":2,"service_date":"2023-06-22","total_present":1305},
{"branch":5,"service":1,"service_date":"2016-11-14","total_present":1568},
{"branch":5,"service":1,"service_date":"2025-06-10","total_present":1662},
{"branch":5,"service":3,"service_date":"2014-01-22","total_present":1701},
{"branch":5,"service":3,"service_date":"2022-10-12","total_present":168},
{"branch":5,"service":3,"service_date":"2019-12-11","total_present":147},
{"branch":5,"service":2,"service_date":"2022-08-30","total_present":1754},
{"branch":5,"service":3,"service_date":"2015-10-09","total_present":1302},
{"branch":5,"service":3,"service_date":"2020-01-21","total_present":655},
{"branch":5,"service":3,"service_date":"2020-11-17","total_present":884},
{"branch":5,"service":1,"service_date":"2023-12-19","total_present":1793},
{"branch":5,"service":2,"service_date":"2017-03-01","total_present":903},
{"branch":5,"service":3,"service_date":"2024-04-09","total_present":1261},
{"branch":5,"service":2,"service_date":"2014-09-17","total_present":1413},
{"branch":5,"service":1,"service_date":"2013-05-23","total_present":1749},
{"branch":5,"service":2,"service_date":"2014-12-26","total_present":1359},
{"branch":5,"service":2,"service_date":"2018-11-07","total_present":1129},
{"branch":5,"service":2,"service_date":"2011-09-19","total_present":1503},
{"branch":5,"service":1,"service_date":"2010-08-25","total_present":188},
{"branch":5,"service":1,"service_date":"2023-11-23","total_present":1083},
{"branch":5,"service":1,"service_date":"2015-12-25","total_present":1056},
{"branch":5,"service":3,"service_date":"2023-03-30","total_present":1486},
{"branch":5,"service":3,"service_date":"2018-09-06","total_present":1705},
{"branch":5,"service":3,"service_date":"2014-12-18","total_present":559},
{"branch":5,"service":1,"service_date":"2018-06-18","total_present":1917},
{"branch":5,"service":1,"service_date":"2011-09-22","total_present":210},
{"branch":5,"service":2,"service_date":"2020-02-28","total_present":912}]

def load_attendances():
    for record in records:
        branch_id = record.get("branch")
        service_id = record.get("service")
        service_date = record.get("service_date")
        total_present = record.get("total_present")
        
        date_obj = format_date(service_date)


        branch = Branch.objects.get(id=branch_id)
        service = ChurchService.objects.get(id=service_id)
        
        metric_log = ServiceAttendanceMetric.objects.filter(
            branch=branch,
            service=service,
            service_date=date_obj
        ).first()

        if metric_log:
            metric_log.total_present += int(total_present)
            metric_log.save()
        else:
            metric_log = ServiceAttendanceMetric.objects.create(
                branch=branch,
                service=service,
                total_present=total_present,
                service_date=date_obj
            )
            metric_log.month = get_month_name(date_obj.month)
            metric_log.year = date_obj.year
            metric_log.save()


        UserActionLog.objects.create(
            user=user,
            action_type="Record Service Attendance",
            action_description=f"Recorded attendance for {service.name} on {service_date} at {branch.name}",
            metadata={
                "branch_id": branch.id,
                "branch_name": branch.name,
                "service_id": service.id,
                "service_name": service.name,
                "service_date": service_date,
                "total_present": total_present
            },
        )
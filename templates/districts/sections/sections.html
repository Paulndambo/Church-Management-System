{% extends 'base1.html' %}
{% load static %}

{% block content %}
<div class="container-fluid">
                <div class="section-header mb-4">
                    <h2>KAG Sections</h2>
                    <div class="d-flex gap-2">
                        <div class="search-input">
                            <i class="fas fa-search"></i>
                            <input type="text" class="form-control" placeholder="Search..." id="searchInput">
                        </div>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newChurchSectionModal">
                            <i class="fas fa-plus me-2"></i> Add Section
                        </button>
                    </div>
                </div>
                <div class="row" id="sectionsContainer">
                    <!-- Section Cards -->
                     {% for section in sections %}
                    <div class="col-md-6 col-lg-4 mb-4">
                        <div class="card section-card h-100">
                            <div class="card-body">
                                <div class="section-header">
                                    <h5 class="card-title mb-0">{{ section.name }}</h5>
                                    <div class="section-actions">
                                        <a href="{% url 'section-detail' section.id %}" class="btn btn-info btn-sm">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                        <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#editChurchSectionModal17">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </div>
                                </div>
                                <p class="card-text mb-1"><strong>District:</strong> {{section.district}}</p>
                                <p class="card-text mb-0"><strong>Presbyter:</strong> {{section.presbyter.name}}</p>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                    {% if is_paginated %}
<nav>
  <ul class="pagination mb-0">
    <!-- Previous -->
    {% if page_obj.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}">Previous</a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Previous</span></li>
    {% endif %}
    <!-- Page numbers -->
    {% for num in paginator.page_range %}
      {% if num == 1 or num == paginator.num_pages %}
        {# Always show first and last page #}
        {% if num == page_obj.number %}
          <li class="page-item active"><span class="page-link">{{ num }}</span></li>
        {% else %}
          <li class="page-item"><a class="page-link" href="?page={{ num }}{% if search_query %}&search={{ search_query }}{% endif %}">{{ num }}</a></li>
        {% endif %}

      {% elif num >= page_obj.number|add:"-2" and num <= page_obj.number|add:"2" %}
        {# Show nearby pages #}
        {% if num == page_obj.number %}
          <li class="page-item active"><span class="page-link">{{ num }}</span></li>
        {% else %}
          <li class="page-item"><a class="page-link" href="?page={{ num }}{% if search_query %}&search={{ search_query }}{% endif %}">{{ num }}</a></li>
        {% endif %}

      {% elif num == page_obj.number|add:"-3" or num == page_obj.number|add:"3" %}
        <li class="page-item disabled"><span class="page-link">â€¦</span></li>
      {% endif %}
    {% endfor %}

    <!-- Next -->
    {% if page_obj.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}">Next</a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Next</span></li>
    {% endif %}
  </ul>
</nav>
{% endif %}
                </div>
            </div>
{% endblock content %}
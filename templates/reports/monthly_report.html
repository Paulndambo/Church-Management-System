<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Monthly Church Report</title>
  <style>
    @page {
      size: A4 landscape;
      margin: 15mm;
    }

    :root {
      --muted: #555;
      --accent: #0b66c3;
      --line: #ccc;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    body {
      background: #f4f4f4;
      display: flex;
      justify-content: center;
      padding: 2rem;
    }

    .report-container {
      background: white;
      width: 297mm;
      min-height: 210mm;
      padding: 15mm;
      box-sizing: border-box;
      box-shadow: 0 0 8px rgba(0,0,0,0.15);
    }

    h1, h2 {
      text-align: center;
      margin: 0.5rem 0;
      color: var(--accent);
    }

    .church-info {
      text-align: center;
      margin-bottom: 1.5rem;
    }

    .church-info p {
      margin: 0.2rem 0;
      color: var(--muted);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1.5rem;
      font-size: 0.9rem;
      page-break-inside: avoid; /* don't split tables */
    }

    table, th, td {
      border: 1px solid var(--line);
    }

    th, td {
      padding: 0.5rem;
      text-align: center;
    }

    tfoot td {
      font-weight: bold;
      background: #f9f9f9;
    }

    .section {
      margin-bottom: 2rem;
      page-break-inside: avoid; /* prevent breaks inside */
    }

    .signatures {
      display: flex;
      justify-content: space-around;
      margin-top: 2rem;
      page-break-before: always; /* force new page for signatures */
    }

    .signature-line {
      width: 30%;
      text-align: center;
    }

    .signature-line span {
      display: block;
      border-top: 1px solid var(--line);
      margin-top: 3rem;
      padding-top: 0.3rem;
      color: var(--muted);
    }

    #download {
      margin-bottom: 1rem;
      padding: 0.6rem 1.2rem;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
    }

    #download:hover {
      background: #094a8b;
    }
  </style>
</head>
<body>
  <div>
    <button id="download">Download PDF</button>

    <div class="report-container" id="report">
      <h1>Monthly Church Report</h1>

      <div class="church-info">
        <p><strong>Church Name:</strong> New Life Church</p>
        <p><strong>Section:</strong> Youth Fellowship</p>
        <p><strong>Pastor's Name:</strong> Rev. John Doe</p>
        <p><strong>Report Month:</strong> August 2025</p>
      </div>

      <!-- Revenue Section -->
      <div class="section">
        <h2>Revenue</h2>
        <table>
          <thead>
            <tr>
              <th>Service Week</th>
              <th>Sunday School Offering</th>
              <th>Tithe</th>
              <th>Offering</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>Week 1</td><td>1000</td><td>5000</td><td>3000</td></tr>
            <tr><td>Week 2</td><td>1200</td><td>4800</td><td>3200</td></tr>
            <tr><td>Week 3</td><td>1100</td><td>5300</td><td>3100</td></tr>
            <tr><td>Week 4</td><td>1300</td><td>5500</td><td>3400</td></tr>
            <tr><td>Week 5</td><td>1250</td><td>5200</td><td>3300</td></tr>
          </tbody>
          <tfoot>
            <tr>
              <td>Total</td>
              <td>5850</td>
              <td>25800</td>
              <td>16000</td>
            </tr>
          </tfoot>
        </table>
      </div>

      <!-- Attendance Section -->
      <div class="section">
        <h2>Attendance</h2>
        <table>
          <thead>
            <tr>
              <th>Service Week</th>
              <th>Men</th>
              <th>Women</th>
              <th>Children</th>
              <th>Pastor's Signature</th>
              <th>Treasurer's Signature</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>Week 1</td><td>30</td><td>40</td><td>20</td><td></td><td></td></tr>
            <tr><td>Week 2</td><td>35</td><td>42</td><td>18</td><td></td><td></td></tr>
            <tr><td>Week 3</td><td>32</td><td>39</td><td>22</td><td></td><td></td></tr>
            <tr><td>Week 4</td><td>34</td><td>41</td><td>25</td><td></td><td></td></tr>
            <tr><td>Week 5</td><td>36</td><td>43</td><td>21</td><td></td><td></td></tr>
          </tbody>
          <tfoot>
            <tr>
              <td>Total</td>
              <td>167</td>
              <td>205</td>
              <td>106</td>
              <td></td>
              <td></td>
            </tr>
          </tfoot>
        </table>
      </div>

      <!-- Expenses Section -->
      <div class="section">
        <h2>Expenses & Expenditures</h2>
        <table>
          <thead>
            <tr>
              <th>Item</th>
              <th>Amount (KES)</th>
              <th>Remarks</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>Church Maintenance</td><td>5000</td><td>Repairs & Cleaning</td></tr>
            <tr><td>Youth Program</td><td>3000</td><td>Event Costs</td></tr>
            <tr><td>Charity Giving</td><td>4000</td><td>Support for Needy Families</td></tr>
          </tbody>
          <tfoot>
            <tr><td>Total</td><td>12000</td><td></td></tr>
          </tfoot>
        </table>
      </div>

      <!-- Signatures -->
      <div class="signatures">
        <div class="signature-line"><span>Pastor's Signature</span></div>
        <div class="signature-line"><span>Treasurer's Signature</span></div>
        <div class="signature-line"><span>Secretary's Signature</span></div>
      </div>
    </div>
  </div>

  <!-- html2pdf.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script>
    document.getElementById("download").addEventListener("click", () => {
      const element = document.getElementById("report");
      const opt = {
        margin:       0,
        filename:     'Monthly_Church_Report.pdf',
        image:        { type: 'jpeg', quality: 0.98 },
        html2canvas:  { scale: 2 },
        jsPDF:        { unit: 'mm', format: 'a4', orientation: 'landscape' }
      };
      html2pdf().from(element).set(opt).save();
    });
  </script>
</body>
</html>
